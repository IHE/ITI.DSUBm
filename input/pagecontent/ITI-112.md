This section corresponds to transaction [ITI-112] Resource Notify of the IHE Technical Framework. Transaction [ITI-112] Resource Notify is used by the Resource Notification Broker and Resource Notification Recipient. The [ITI-112] transaction is used to notify a publication event that matches a subscription criteria.

### Scope

The Resource Notify [ITI-112] transaction passes a Notificanion Bundle Request from a Resource Notification Broker to a Resource Notification Recipient. This transaction is used to inform the Resource Notification Recipient that a publication event matches the subscription criteria from an active Subscription resource. 

### Actors Roles

**Table: Actor Roles**

|Actor | Role |
|-------------------+--------------------------|
| [Resource Notification Broker](volume-1.html#broker)    | Sends the Notificanion Bundle Request to the Resource Notification Recipient |
| [Resource Notification Recipient](volume-1.html#recipient) | Receives the notification |

### Referenced Standards

**FHIR-R4B** [HL7 FHIR Release 4.3.0](https://www.hl7.org/FHIR/R4B)

### Interactions

<figure>
{%include ITI-112-Notification-seq.svg%}
<figcaption><b>Figure 2:3.112: ITI-112 interactions</b></figcaption>
</figure>
<br clear="all">

**Figure: Go Interactions**


#### Notification Bundle Request
This message uses the HTTP POST method on the target Resource Notification Recipient endpoint to submit the bundle resource.

##### Trigger Events

This method is invoked when Resource Notification Broker has received a Resource Publish [ITI-111] that matches one (or more) subscription criteria included in the subscription resources with status=="active". 

##### Message Semantics

The Resource Notification broker shall initiate an HTTP request according to requirements defined in the HL7® FHIR® standard for “create” interaction (https://hl7.org/fhir/R4B/http.html#create). The message uses an HTTP POST method to submit a [Bundle](https://build.fhir.org/ig/HL7/fhir-subscription-backport-ig/StructureDefinition-backport-subscription-notification.html) FHIR Resource with the type of history. In this way the Bundle will contain the change on the Fhir resource triggered by the Resource Publish [ITI-111].

The notification Bundle MUST have a SubscriptionStatus as the first entry. This element is necessary to describe during notifications the state of the Subscription that has been triggered. 
The content of the notification is based on the SubscriptionTopic.notificationShape which indicates which resource shall be included in the notification. 

The level of detail of these resources, that the Resource Notification Broker should use in the Notification Bundle, is indicated in the Subscription.payload element. For this element are possible 3 different type of vaalues: empty, id-only and full-resource as defined by this [extension](https://build.fhir.org/ig/HL7/fhir-subscription-backport-ig/StructureDefinition-backport-payload-content.html#root). The 

The Notification Bundle Request message is sent to the endpoint indicated in the Subscription.channel.endpoint

The content-type of the POST SHALL match the MIME type on the Subscription.channel.payload element 
??? Each Subscription.channel.header value SHALL be conveyed as an HTTP request header. [see header](http://hl7.org/fhir/R4B/subscription.html#2.46.8.1)

##### Expected Actions

The Resource Notification Recipient processes the results according to application-defined rules.

#### Notification Bundle Response

##### Trigger Events

''TODO: define the triggers''

##### Message Semantics

''TODO: define the message -- usually with a StructureDefintion''

##### Expected Actions

''TODO: define expected actions''


### CapabilityStatement Resource

Server implementing this transaction shall provide a CapabilityStatement Resource as described in ITI TF-2x: Appendix Z.3 indicating the transaction has been implemented. 
* Requirements CapabilityStatement for [Client](CapabilityStatement-IHE.ToDo.client.html)
* Requirements CapabilityStatement for [Server](CapabilityStatement-IHE.ToDo.server.html)

### Security Considerations

See [MHD Security Considerations](volume-1.html#security-considerations)

#### Security Audit Considerations

''TODO: The security audit criteria ''

##### Client Audit 

''TODO: the specifics''

##### Server Audit 

''TODO: the specifics''
